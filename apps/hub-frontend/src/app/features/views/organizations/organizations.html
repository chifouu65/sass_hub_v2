<div class="py-8 bg-slate-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
    <div
      class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"
    >
      <div>
        <h1 class="text-3xl font-bold text-slate-900">Organisations</h1>
        <p class="text-sm text-slate-600">
          Créez, modifiez et gérez les membres de vos organisations
          multi-tenant.
        </p>
      </div>
      <div class="flex items-center gap-2">
        <button
          type="button"
          class="btn btn-secondary"
          routerLink="/dashboard"
        >
          Retour au tableau de bord
        </button>
        <div class="flex items-center gap-2">
          @if (organizations().length > 0) {
          <select
            class="form-select md:w-56"
            [value]="selectedOrganizationId() ?? ''"
            (change)="onOrganizationSelectChange($event)"
          >
            @for (organization of organizations(); track organization.id) {
            <option [value]="organization.id">
              {{ organization.name }}
            </option>
            }
          </select>
          }
          <button
            type="button"
            (click)="onRefresh()"
            class="btn btn-primary"
          >
            Rafraîchir
          </button>
        </div>
      </div>
    </div>

    @if (error(); as message) {
    <div
      class="rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700"
    >
      {{ message }}
    </div>
    }

    <div class="md:flex md:gap-6">
      <ul
        class="mb-4 flex flex-col gap-2 text-sm font-medium text-gray-600 md:mb-0 md:me-4"
      >
        @for (tab of tabs; track tab.id) {
        <li>
          <button
            type="button"
            (click)="setActiveTab(tab.id)"
            class="inline-flex w-full items-center gap-2 rounded-lg px-4 py-3 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
            [ngClass]="
              isActiveTab(tab.id)
                ? 'bg-blue-700 text-white'
                : 'bg-gray-50 text-gray-600 hover:bg-gray-100 hover:text-gray-900'
            "
            [attr.aria-current]="isActiveTab(tab.id) ? 'page' : null"
          >
            @switch (tab.id) { @case ('organizations') {
            <svg
              class="h-4 w-4"
              [ngClass]="
                isActiveTab(tab.id)
                  ? 'text-white'
                  : 'text-gray-500'
              "
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                d="M10 0a10 10 0 1 0 10 10A10.011 10.011 0 0 0 10 0Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 13a8.949 8.949 0 0 1-4.951-1.488A3.987 3.987 0 0 1 9 13h2a3.987 3.987 0 0 1 3.951 3.512A8.949 8.949 0 0 1 10 18Z"
              />
            </svg>
            } @case ('applications') {
            <svg
              class="h-4 w-4"
              [ngClass]="
                isActiveTab(tab.id)
                  ? 'text-white'
                  : 'text-gray-500'
              "
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                d="M4 2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4Z"
              />
              <path
                d="M13 2a2 2 0 0 0-2 2v1h5V4a2 2 0 0 0-2-2h-1Zm-2 5v3a2 2 0 0 0 2 2h1V7h-3Zm5 0v8H7v-3H4a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h9a2 2 0 0 0 2-2h1a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-1Z"
              />
            </svg>
            } @case ('members') {
            <svg
              class="h-4 w-4"
              [ngClass]="
                isActiveTab(tab.id)
                  ? 'text-white'
                  : 'text-gray-500'
              "
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 18 18"
            >
              <path
                d="M6.143 0H1.857A1.857 1.857 0 0 0 0 1.857v4.286C0 7.169.831 8 1.857 8h4.286A1.857 1.857 0 0 0 8 6.143V1.857A1.857 1.857 0 0 0 6.143 0Zm10 0h-4.286A1.857 1.857 0 0 0 10 1.857v4.286C10 7.169 10.831 8 11.857 8h4.286A1.857 1.857 0 0 0 18 6.143V1.857A1.857 1.857 0 0 0 16.143 0Zm-10 10H1.857A1.857 1.857 0 0 0 0 11.857v4.286C0 17.169.831 18 1.857 18h4.286A1.857 1.857 0 0 0 8 16.143v-4.286A1.857 1.857 0 0 0 6.143 10Zm10 0h-4.286A1.857 1.857 0 0 0 10 11.857v4.286c0 1.026.831 1.857 1.857 1.857h4.286A1.857 1.857 0 0 0 18 16.143v-4.286A1.857 1.857 0 0 0 16.143 10Z"
              />
            </svg>
            } @case ('roles') {
            <svg
              class="h-4 w-4"
              [ngClass]="
                isActiveTab(tab.id)
                  ? 'text-white'
                  : 'text-gray-500'
              "
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                d="M18 7.5h-.423l-.452-1.09.3-.3a1.5 1.5 0 0 0 0-2.121L16.01 2.575a1.5 1.5 0 0 0-2.121 0l-.3.3-1.089-.452V2A1.5 1.5 0 0 0 11 .5H9A1.5 1.5 0 0 0 7.5 2v.423l-1.09.452-.3-.3a1.5 1.5 0 0 0-2.121 0L2.576 3.99a1.5 1.5 0 0 0 0 2.121l.3.3L2.423 7.5H2A1.5 1.5 0 0 0 .5 9v2A1.5 1.5 0 0 0 2 12.5h.423l.452 1.09-.3.3a1.5 1.5 0 0 0 0 2.121l1.415 1.413a1.5 1.5 0 0 0 2.121 0l.3-.3 1.09.452V18A1.5 1.5 0 0 0 9 19.5h2a1.5 1.5 0 0 0 1.5-1.5v-.423l1.09-.452.3.3a1.5 1.5 0 0 0 2.121 0l1.415-1.414a1.5 1.5 0 0 0 0-2.121l-.3-.3.452-1.09H18a1.5 1.5 0 0 0 1.5-1.5V9A1.5 1.5 0 0 0 18 7.5Zm-8 6a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Z"
              />
            </svg>
            } }
            <span class="truncate">{{ tab.label }}</span>
          </button>
        </li>
        }
      </ul>

      <div class="flex-1">
        @switch (activeTab()) { @case ('organizations') {
        <app-organization-table></app-organization-table>
        } @case ('applications') {
        <div
          class="rounded-lg bg-gray-50 p-6 shadow-sm"
        >
          <app-organization-applications></app-organization-applications>
        </div>
        } @case ('members') {
        <div
          class="rounded-lg bg-gray-50 p-6 shadow-sm"
        >
          <app-organization-members></app-organization-members>
        </div>
        } @case ('roles') {
        <div
          class="rounded-lg bg-gray-50 p-6 shadow-sm"
        >
          <app-organization-roles></app-organization-roles>
        </div>
        } }
      </div>
    </div>

  </div>

</div>

